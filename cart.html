<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Shopping Cart - Review your items and checkout at Cartfolio">
    <meta name="keywords" content="shopping cart, checkout, e-commerce">
    <title>Shopping Cart - Cartfolio</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#111827',
                        accent: '#2563eb'
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
</head>
<body class="font-inter bg-gray-50 text-primary">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center space-x-2">
                        <img src="assets/logo.png" alt="Cartfolio Logo" class="h-8 w-8" loading="lazy">
                        <span class="text-xl font-bold text-primary">Cartfolio</span>
                    </a>
                </div>
                
                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-primary hover:text-accent transition-colors font-medium">Home</a>
                    <a href="products.html" class="text-primary hover:text-accent transition-colors font-medium">Products</a>
                    <a href="cart.html" class="text-accent font-medium relative">
                        Cart
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-accent text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                    </a>
                </div>
                
                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-primary hover:text-accent">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden hidden pb-4">
                <a href="index.html" class="block py-2 text-primary hover:text-accent transition-colors font-medium">Home</a>
                <a href="products.html" class="block py-2 text-primary hover:text-accent transition-colors font-medium">Products</a>
                <a href="cart.html" class="block py-2 text-accent font-medium">Cart</a>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="bg-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h1 class="text-3xl md:text-4xl font-bold text-primary mb-4">Shopping Cart</h1>
            <p class="text-gray-600 text-lg">Review your items and proceed to checkout</p>
        </div>
    </section>

    <!-- Cart Content -->
    <section class="py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                <!-- Cart Items -->
                <div class="lg:col-span-2">
                    <div id="cart-items" class="space-y-6">
                        <!-- Cart items will be loaded here -->
                    </div>
                    
                    <!-- Empty Cart Message -->
                    <div id="empty-cart" class="text-center py-12 hidden">
                        <svg class="mx-auto h-24 w-24 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5-6m0 0h15M17 13v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6"></path>
                        </svg>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">Your cart is empty</h3>
                        <p class="text-gray-500 mb-6">Add some products to get started</p>
                        <a href="products.html" class="bg-accent hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors inline-block">
                            Continue Shopping
                        </a>
                    </div>
                </div>
                
                <!-- Order Summary -->
                <div class="lg:col-span-1">
                    <div id="order-summary" class="bg-white rounded-lg shadow-md p-6 sticky top-24">
                        <h2 class="text-xl font-semibold mb-6">Order Summary</h2>
                        
                        <div class="space-y-4 mb-6">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Subtotal</span>
                                <span id="subtotal" class="font-semibold">$0.00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Shipping</span>
                                <span class="font-semibold text-green-600">Free</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Tax</span>
                                <span id="tax" class="font-semibold">$0.00</span>
                            </div>
                            <div class="border-t border-gray-200 pt-4">
                                <div class="flex justify-between text-lg font-bold">
                                    <span>Total</span>
                                    <span id="total" class="text-accent">$0.00</span>
                                </div>
                            </div>
                        </div>
                        
                        <button id="checkout-btn" onclick="proceedToCheckout()" 
                                class="w-full bg-accent hover:bg-blue-700 text-white font-semibold py-4 px-6 rounded-lg transition-colors text-lg mb-4 disabled:opacity-50 disabled:cursor-not-allowed">
                            Proceed to Checkout
                        </button>
                        
                        <div id="checkout-info" class="text-sm text-gray-600 bg-blue-50 p-4 rounded-lg hidden">
                            <p class="font-semibold mb-2">Checkout Information:</p>
                            <p class="mb-2">• For single items: Direct Stripe Payment Link</p>
                            <p class="mb-2">• For multiple items: First item's payment link opens</p>
                            <p>• Multiple items require manual order combination - see instructions after clicking checkout</p>
                        </div>
                        
                        <a href="products.html" class="block text-center text-accent hover:text-blue-700 font-medium mt-4">
                            Continue Shopping
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-primary text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <img src="assets/logo.png" alt="Cartfolio Logo" class="h-8 w-8" loading="lazy">
                        <span class="text-xl font-bold">Cartfolio</span>
                    </div>
                    <p class="text-gray-300">Your premium e-commerce destination for quality products.</p>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-300 hover:text-white transition-colors">Home</a></li>
                        <li><a href="products.html" class="text-gray-300 hover:text-white transition-colors">Products</a></li>
                        <li><a href="cart.html" class="text-gray-300 hover:text-white transition-colors">Cart</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-4">Categories</h4>
                    <ul class="space-y-2">
                        <li><a href="products.html?category=electronics" class="text-gray-300 hover:text-white transition-colors">Electronics</a></li>
                        <li><a href="products.html?category=clothing" class="text-gray-300 hover:text-white transition-colors">Clothing</a></li>
                        <li><a href="products.html?category=accessories" class="text-gray-300 hover:text-white transition-colors">Accessories</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-4">Contact</h4>
                    <p class="text-gray-300">Email: hello@cartfolio.com</p>
                    <p class="text-gray-300">Phone: (555) 123-4567</p>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center">
                <p class="text-gray-300">&copy; 2024 Cartfolio. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full p-6">
                <h3 class="text-xl font-semibold mb-4">Checkout Instructions</h3>
                <div id="modal-content">
                    <!-- Content will be populated by JavaScript -->
                </div>
                <div class="flex gap-4 mt-6">
                    <button onclick="closeCheckoutModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded transition-colors">
                        Cancel
                    </button>
                    <button id="proceed-payment" class="flex-1 bg-accent hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition-colors">
                        Proceed to Payment
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="scripts/cart.js"></script>
    <script>
        let allProducts = [];

        // Mobile menu toggle
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts().then(() => {
                displayCart();
                updateCartCount();
            });
        });

        /**
         * Load products data
         */
        async function loadProducts() {
            try {
                const response = await fetch('data/products.json');
                allProducts = await response.json();
            } catch (error) {
                console.error('Error loading products:', error);
            }
        }

        /**
         * Display cart items
         */
        function displayCart() {
            const cart = getCart();
            const cartItemsContainer = document.getElementById('cart-items');
            const emptyCartContainer = document.getElementById('empty-cart');
            const orderSummary = document.getElementById('order-summary');

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '';
                emptyCartContainer.classList.remove('hidden');
                orderSummary.classList.add('hidden');
                return;
            }

            emptyCartContainer.classList.add('hidden');
            orderSummary.classList.remove('hidden');

            cartItemsContainer.innerHTML = cart.map(item => {
                const product = allProducts.find(p => p.id === item.id);
                if (!product) return '';

                return `
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <div class="flex flex-col md:flex-row gap-6">
                            <img src="${product.image}" alt="${product.name}" class="w-full md:w-32 h-32 object-cover rounded-lg">
                            
                            <div class="flex-1">
                                <h3 class="text-xl font-semibold mb-2">${product.name}</h3>
                                <p class="text-gray-600 mb-4">${product.description}</p>
                                <p class="text-lg font-bold text-accent">$${(product.price / 100).toFixed(2)} each</p>
                            </div>
                            
                            <div class="flex flex-col items-end gap-4">
                                <div class="flex items-center gap-3">
                                    <button onclick="updateQuantity(${item.id}, ${item.quantity - 1})" 
                                            class="bg-gray-200 hover:bg-gray-300 text-gray-800 w-8 h-8 rounded-full flex items-center justify-center transition-colors">
                                        -
                                    </button>
                                    <span class="text-lg font-semibold w-8 text-center">${item.quantity}</span>
                                    <button onclick="updateQuantity(${item.id}, ${item.quantity + 1})" 
                                            class="bg-gray-200 hover:bg-gray-300 text-gray-800 w-8 h-8 rounded-full flex items-center justify-center transition-colors">
                                        +
                                    </button>
                                </div>
                                
                                <div class="text-xl font-bold">
                                    $${((product.price * item.quantity) / 100).toFixed(2)}
                                </div>
                                
                                <button onclick="removeFromCart(${item.id})" 
                                        class="text-red-600 hover:text-red-800 font-medium transition-colors">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            updateOrderSummary();
        }

        /**
         * Update order summary calculations
         */
        function updateOrderSummary() {
            const cart = getCart();
            let subtotal = 0;

            cart.forEach(item => {
                const product = allProducts.find(p => p.id === item.id);
                if (product) {
                    subtotal += product.price * item.quantity;
                }
            });

            const tax = Math.round(subtotal * 0.08); // 8% tax
            const total = subtotal + tax;

            document.getElementById('subtotal').textContent = `$${(subtotal / 100).toFixed(2)}`;
            document.getElementById('tax').textContent = `$${(tax / 100).toFixed(2)}`;
            document.getElementById('total').textContent = `$${(total / 100).toFixed(2)}`;

            // Enable/disable checkout button
            const checkoutBtn = document.getElementById('checkout-btn');
            checkoutBtn.disabled = cart.length === 0;
        }

        /**
         * Update item quantity in cart
         */
        function updateQuantity(productId, newQuantity) {
            if (newQuantity <= 0) {
                removeFromCart(productId);
                return;
            }

            const cart = getCart();
            const itemIndex = cart.findIndex(item => item.id === productId);
            
            if (itemIndex !== -1) {
                cart[itemIndex].quantity = newQuantity;
                saveCart(cart);
                displayCart();
                updateCartCount();
            }
        }

        /**
         * Proceed to checkout
         */
        function proceedToCheckout() {
            const cart = getCart();
            
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }

            if (cart.length === 1) {
                // Single item - direct to Stripe Payment Link
                const product = allProducts.find(p => p.id === cart[0].id);
                if (product && product.stripe_payment_link && product.stripe_payment_link !== 'YOUR_STRIPE_PAYMENT_LINK_HERE') {
                    window.open(product.stripe_payment_link, '_blank');
                } else {
                    showCheckoutModal('single');
                }
            } else {
                // Multiple items - show instructions
                showCheckoutModal('multiple');
            }
        }

        /**
         * Show checkout modal with instructions
         */
        function showCheckoutModal(type) {
            const modal = document.getElementById('checkout-modal');
            const modalContent = document.getElementById('modal-content');
            const proceedBtn = document.getElementById('proceed-payment');
            const cart = getCart();

            if (type === 'single') {
                const product = allProducts.find(p => p.id === cart[0].id);
                modalContent.innerHTML = `
                    <p class="mb-4">You're about to purchase:</p>
                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                        <p class="font-semibold">${product.name}</p>
                        <p class="text-gray-600">Quantity: ${cart[0].quantity}</p>
                        <p class="text-lg font-bold text-accent">$${((product.price * cart[0].quantity) / 100).toFixed(2)}</p>
                    </div>
                    <p class="text-sm text-gray-600">Note: This is a demo site. Replace "YOUR_STRIPE_PAYMENT_LINK_HERE" in products.json with actual Stripe Payment Links.</p>
                `;
                proceedBtn.onclick = () => {
                    closeCheckoutModal();
                    alert('Demo: Stripe Payment Link would open here. Please configure your payment links in products.json');
                };
            } else {
                modalContent.innerHTML = `
                    <p class="mb-4">You have multiple items in your cart:</p>
                    <div class="bg-gray-50 p-4 rounded-lg mb-4 max-h-40 overflow-y-auto">
                        ${cart.map(item => {
                            const product = allProducts.find(p => p.id === item.id);
                            return `
                                <div class="flex justify-between items-center py-1">
                                    <span>${product.name} (${item.quantity}x)</span>
                                    <span class="font-semibold">$${((product.price * item.quantity) / 100).toFixed(2)}</span>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                        <p class="text-sm text-yellow-800">
                            <strong>Static Site Limitation:</strong> This demo will open the first item's payment link. 
                            For multiple items, you'll need to manually combine orders or use a full e-commerce solution.
                        </p>
                    </div>
                    <p class="text-sm text-gray-600">
                        For production use, consider integrating with Stripe Checkout Sessions or a full e-commerce platform.
                    </p>
                `;
                proceedBtn.onclick = () => {
                    const firstProduct = allProducts.find(p => p.id === cart[0].id);
                    closeCheckoutModal();
                    if (firstProduct && firstProduct.stripe_payment_link && firstProduct.stripe_payment_link !== 'YOUR_STRIPE_PAYMENT_LINK_HERE') {
                        window.open(firstProduct.stripe_payment_link, '_blank');
                    } else {
                        alert('Demo: Please configure Stripe Payment Links in products.json');
                    }
                };
            }

            modal.classList.remove('hidden');
        }

        /**
         * Close checkout modal
         */
        function closeCheckoutModal() {
            document.getElementById('checkout-modal').classList.add('hidden');
        }

        // Close modal when clicking outside
        document.getElementById('checkout-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCheckoutModal();
            }
        });
    </script>
</body>
</html>
